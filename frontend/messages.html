<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ProjectHub - Messages</title>
    <link rel="stylesheet" href="messages.css" />
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-left">
                <a href="home.html" class="logo-link">
                    <h1 class="logo">ProjectHub</h1>
                </a>
            </div>
            <div class="nav-center">
                <h2 class="page-title">Messages</h2>
            </div>
            <div class="nav-right">
                <button id="backBtn" class="back-btn" title="Go Back">‚Üê Back</button>

                <!-- User Profile Dropdown -->
                <div class="user-menu">
                    <button class="user-menu-btn" id="userMenuBtn">
                        <div class="user-avatar">
                            <span id="userInitials">U</span>
                        </div>
                        <div class="user-info">
                            <span class="user-name" id="userName">Loading...</span>
                        </div>
                        <svg class="dropdown-arrow" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>

                    <!-- Dropdown Menu (no logout) -->
                    <div class="dropdown-menu" id="dropdownMenu">
                        <a href="home.html" class="dropdown-item">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                                <polyline points="9 22 9 12 15 12 15 22" />
                            </svg>
                            <span>Home</span>
                        </a>
                        <a href="view-profile.html" class="dropdown-item">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                                <circle cx="12" cy="7" r="4" />
                            </svg>
                            <span>View Profile</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="messages-container">
        <!-- Conversations List -->
        <div class="conversations-panel">
            <div class="conversations-header">
                <h2>Conversations</h2>
                <button class="btn btn-icon" id="newMessageBtn" title="New Message">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </button>
            </div>

            <div class="conversations-search">
                <input type="text" id="searchConversations" placeholder="Search conversations...">
            </div>

            <div id="conversationsLoading" class="loading-state">
                <div class="loader"></div>
                <p>Loading conversations...</p>
            </div>

            <div id="conversationsList" class="conversations-list"></div>

            <div id="conversationsEmpty" class="empty-state" style="display: none;">
                <p>No conversations yet</p>
                <button class="btn btn-primary" id="emptyNewMessageBtn">Start a conversation</button>
            </div>
        </div>

        <!-- Chat Area -->
        <div class="chat-panel">
            <div id="noChatSelected" class="no-chat-selected">
                <div class="empty-icon">üí¨</div>
                <h3>No conversation selected</h3>
                <p>Choose a conversation or start a new one</p>
            </div>

            <div id="chatContent" class="chat-content" style="display: none;">
                <!-- Chat Header -->
                <div class="chat-header">
                    <div class="chat-user-info">
                        <div class="user-avatar">
                            <span id="chatUserInitials">U</span>
                        </div>
                        <div>
                            <h3 id="chatUserName">User Name</h3>
                            <p id="chatUserPosition">Position</p>
                        </div>
                    </div>
                </div>

                <!-- Messages Area -->
                <div id="messagesArea" class="messages-area"></div>

                <!-- Message Input -->
                <div class="message-input-area">
                    <form id="messageForm" class="message-form">
                        <input 
                            type="text" 
                            id="messageInput" 
                            placeholder="Type a message..." 
                            required
                            autocomplete="off"
                        >
                        <button type="submit" class="send-btn" title="Send">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M16.6915026,12.4744748 L3.50612381,13.2599618 C3.19218622,13.2599618 3.03521743,13.4170592 3.03521743,13.5741566 L1.15159189,20.0151496 C0.8376543,20.8006365 0.99,21.89 1.77946707,22.52 C2.41,22.99 3.50612381,23.1 4.13399899,22.8429026 L21.714504,14.0454487 C22.6563168,13.5741566 23.1272231,12.6315722 22.9702544,11.6889879 C22.9702544,11.6889879 14.0454487,3.03521743 3.50612381,1.77946707 C2.40999899,1.4655294 1.77946707,1.4655294 1.15159189,2.09399899 C0.531588066,2.58636531 0,3.85803046 1.15159189,8.29223263 L3.03521743,14.0454487 C3.03521743,14.2025461 3.03521743,14.3596434 3.50612381,14.3596434 L16.6915026,15.1451304 C16.6915026,15.1451304 17.1624089,15.1451304 17.1624089,14.52 C17.1624089,13.8948605 16.6915026,12.4744748 16.6915026,12.4744748 Z"></path>
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <!-- New Message Modal -->
    <div class="modal" id="newMessageModal">
        <div class="modal-overlay" id="newMessageOverlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Start New Conversation</h3>
                <button class="modal-close" id="newMessageClose">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>

            <div class="modal-body">
                <div class="form-group">
                    <label for="userSearch">Search for users in your organization:</label>
                    <input type="text" id="userSearch" placeholder="Search users...">
                </div>
                <div id="userList" class="user-list"></div>
            </div>
        </div>
    </div>

    <script src="auth-manager.js"></script>
    <script src="messages.js"></script>
</body>
</html>
